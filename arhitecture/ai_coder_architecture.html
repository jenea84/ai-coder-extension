<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Coder Architecture</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: auto;
        }

        .architecture-container {
            position: relative;
            width: 1400px;
            height: 800px;
            margin: 0 auto;
            background: radial-gradient(circle at 50% 50%, #2a2a2a 0%, #1a1a1a 100%);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .block {
            position: absolute;
            background: linear-gradient(135deg, #3a3a3a, #2a2a2a);
            border: 2px solid #4a9eff;
            border-radius: 8px;
            padding: 12px 16px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 158, 255, 0.2);
            z-index: 10;
            pointer-events: auto;
        }

        .block:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(74, 158, 255, 0.4);
            border-color: #66b3ff;
            background: linear-gradient(135deg, #4a4a4a, #3a3a3a);
        }

        .ui-block {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border-color: #ff4757;
        }

        .ui-block:hover {
            background: linear-gradient(135deg, #ff7b7b, #ff5a52);
            border-color: #ff6b6b;
        }

        .core-block {
            background: linear-gradient(135deg, #4834d4, #3742fa);
            border-color: #5742d4;
        }

        .core-block:hover {
            background: linear-gradient(135deg, #5844e4, #4752fb);
            border-color: #6752e4;
        }

        .provider-block {
            background: linear-gradient(135deg, #00d2d3, #01a3a4);
            border-color: #00b8d4;
        }

        .provider-block:hover {
            background: linear-gradient(135deg, #10e2e3, #11b3b4);
            border-color: #10c8e4;
        }

        .storage-block {
            background: linear-gradient(135deg, #ff9ff3, #f368e0);
            border-color: #ff6b9d;
        }

        .storage-block:hover {
            background: linear-gradient(135deg, #ffafff, #ff78f0);
            border-color: #ff7bad;
        }

        .diamond {
            transform: rotate(45deg);
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .diamond-text {
            transform: rotate(-45deg);
            font-size: 11px;
            line-height: 1.2;
        }

        .arrow {
            position: absolute;
            z-index: 10;
        }

        .arrow-line {
            stroke: #4a9eff;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }

        .connection-line {
            stroke: #666;
            stroke-width: 1.5;
            fill: none;
            stroke-dasharray: 5,5;
        }

        .title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
            color: #4a9eff;
            text-shadow: 0 2px 10px rgba(74, 158, 255, 0.3);
        }

        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(42, 42, 42, 0.9);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #4a9eff;
            backdrop-filter: blur(10px);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            margin-right: 8px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            max-width: 250px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid #4a9eff;
        }

        @keyframes pulse {
            0% { box-shadow: 0 4px 15px rgba(74, 158, 255, 0.2); }
            50% { box-shadow: 0 8px 25px rgba(74, 158, 255, 0.5); }
            100% { box-shadow: 0 4px 15px rgba(74, 158, 255, 0.2); }
        }

        .active {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div class="title">AI Coder Extension Architecture</div>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #ff6b6b, #ee5a52);"></div>
            <span>UI Layer</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #4834d4, #3742fa);"></div>
            <span>Core System</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #00d2d3, #01a3a4);"></div>
            <span>AI Providers</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #ff9ff3, #f368e0);"></div>
            <span>Storage</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #3a3a3a, #2a2a2a);"></div>
            <span>Utilities</span>
        </div>
    </div>

    <div class="architecture-container">
        <svg width="100%" height="100%" style="position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;">
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                        refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#4a9eff" />
                </marker>
            </defs>
            
            <!-- Main flow arrows -->
            <line class="arrow-line" x1="120" y1="80" x2="280" y2="80" />
            <line class="arrow-line" x1="380" y1="80" x2="520" y2="80" />
            <line class="arrow-line" x1="620" y1="80" x2="750" y2="80" />
            <line class="arrow-line" x1="850" y1="80" x2="980" y2="80" />
            <line class="arrow-line" x1="1080" y1="80" x2="1200" y2="80" />
            
            <!-- Vertical connections -->
            <line class="connection-line" x1="350" y1="120" x2="350" y2="180" />
            <line class="connection-line" x1="350" y1="220" x2="350" y2="280" />
            <line class="connection-line" x1="350" y1="320" x2="350" y2="400" />
            
            <!-- Provider connections -->
            <line class="connection-line" x1="280" y1="450" x2="180" y2="550" />
            <line class="connection-line" x1="420" y1="450" x2="520" y2="550" />
            
            <!-- Parser to Context -->
            <line class="connection-line" x1="580" y1="120" x2="580" y2="400" />
            
            <!-- Context to Storage -->
            <line class="connection-line" x1="680" y1="400" x2="850" y2="400" />
            
            <!-- Rollback connection -->
            <line class="connection-line" x1="1050" y1="120" x2="1050" y2="200" />
        </svg>

        <!-- UI Layer -->
        <div class="block ui-block" style="top: 50px; left: 50px; width: 140px;" 
             data-tooltip="Пользовательский интерфейс: CommandPalette, ChatPanel, SettingsPanel">
            UI: CommandPalette
        </div>

        <!-- Core System -->
        <div class="block core-block" style="top: 50px; left: 220px; width: 120px;"
             data-tooltip="Реестр команд: регистрация и управление всеми командами системы">
            CommandRegistry
        </div>

        <div class="block core-block" style="top: 150px; left: 280px; width: 140px;"
             data-tooltip="Менеджер сообщений: обработка ввода/вывода, история сообщений">
            MessageManager
        </div>

        <div class="block core-block" style="top: 190px; left: 280px; width: 140px;"
             data-tooltip="Менеджер чатов: управление режимами чата и переключением">
            ChatManager
        </div>

        <div class="block" style="top: 250px; left: 280px; width: 140px;"
             data-tooltip="Парсер кода: анализ кодированных инструкций и операций">
            Parser
        </div>

        <!-- AI Provider Decision -->
        <div class="block diamond provider-block" style="top: 380px; left: 310px;"
             data-tooltip="Выбор AI провайдера на основе настроек пользователя">
            <div class="diamond-text">Выбранный<br>провайдер</div>
        </div>

        <!-- AI Providers -->
        <div class="block provider-block" style="top: 520px; left: 120px; width: 120px;"
             data-tooltip="OpenAI API: GPT-4, GPT-3.5 и другие модели OpenAI">
            OpenAI<br>OpenAIClient
        </div>

        <div class="block provider-block" style="top: 520px; left: 460px; width: 120px;"
             data-tooltip="Anthropic API: Claude и другие модели Anthropic">
            Anthropic<br>AnthropicClient
        </div>

        <!-- Context and Processing -->
        <div class="block" style="top: 50px; left: 460px; width: 120px;"
             data-tooltip="Построитель промптов: формирование запросов для AI">
            PromptBuilder
        </div>

        <div class="block" style="top: 50px; left: 620px; width: 100px;"
             data-tooltip="AI клиент: унифицированный интерфейс для всех провайдеров">
            AIClient
        </div>

        <div class="block" style="top: 50px; left: 760px; width: 80px;"
             data-tooltip="AI API: внешние сервисы искусственного интеллекта">
            AI API
        </div>

        <div class="block" style="top: 370px; left: 520px; width: 120px;"
             data-tooltip="Контекст кода: управление контекстом файлов и проекта">
            CodeContext
        </div>

        <!-- Storage and Cache -->
        <div class="block storage-block" style="top: 370px; left: 780px; width: 140px;"
             data-tooltip="Хранилище данных: чаты, настройки, история, контекст">
            Storage System
        </div>

        <div class="block" style="top: 50px; left: 880px; width: 120px;"
             data-tooltip="Менеджер кэша: кэширование ответов и оптимизация запросов">
            CacheManager
        </div>

        <!-- Rollback System -->
        <div class="block" style="top: 170px; left: 980px; width: 140px;"
             data-tooltip="Система откатов: управление снимками и точками восстановления">
            RollbackManager
        </div>

        <!-- File System -->
        <div class="block" style="top: 190px; left: 680px; width: 80px;"
             data-tooltip="Файловая система: чтение/запись файлов проекта">
            F/G
        </div>

        <!-- Mode System -->
        <div class="block core-block" style="top: 300px; left: 50px; width: 100px;"
             data-tooltip="Режим Чат: базовые команды общения">
            ChatMode
        </div>

        <div class="block core-block" style="top: 350px; left: 50px; width: 100px;"
             data-tooltip="Режим Редактирование: команды редактирования и рефакторинга">
            EditMode
        </div>

        <div class="block core-block" style="top: 400px; left: 50px; width: 100px;"
             data-tooltip="Турбо режим: быстрые команды и экспресс-правки">
            TurboMode
        </div>

        <div class="block core-block" style="top: 450px; left: 50px; width: 100px;"
             data-tooltip="Режим отладки: команды отладки и поиска багов">
            DebugMode
        </div>

        <!-- Additional Systems -->
        <div class="block" style="top: 520px; left: 780px; width: 120px;"
             data-tooltip="Система настроек: конфигурация провайдеров, моделей, UI">
            SettingsManager
        </div>

        <div class="block" style="top: 570px; left: 780px; width: 120px;"
             data-tooltip="Менеджер истории: управление историей чатов по режимам">
            HistoryManager
        </div>

        <!-- Utilities -->
        <div class="block" style="top: 620px; left: 50px; width: 100px;"
             data-tooltip="Утилиты: FileUtils, StringUtils, ValidationUtils, Logger">
            Utils
        </div>

        <div class="block" style="top: 620px; left: 200px; width: 120px;"
             data-tooltip="Обработчик ошибок: централизованная обработка исключений">
            ErrorHandler
        </div>
    </div>

    <div id="tooltip" class="tooltip" style="display: none;"></div>

    <script>
        const blocks = document.querySelectorAll('.block');
        const tooltip = document.getElementById('tooltip');

        blocks.forEach(block => {
            block.addEventListener('mouseenter', (e) => {
                const tooltipText = e.target.getAttribute('data-tooltip');
                if (tooltipText) {
                    tooltip.textContent = tooltipText;
                    tooltip.style.display = 'block';
                    e.target.classList.add('active');
                }
            });

            block.addEventListener('mouseleave', (e) => {
                tooltip.style.display = 'none';
                e.target.classList.remove('active');
            });

            block.addEventListener('mousemove', (e) => {
                tooltip.style.left = (e.pageX + 10) + 'px';
                tooltip.style.top = (e.pageY - 30) + 'px';
            });

            block.addEventListener('click', (e) => {
                // Эффект клика
                e.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.target.style.transform = '';
                }, 150);
            });
        });

        // Анимация появления блоков
        blocks.forEach((block, index) => {
            block.style.opacity = '0';
            block.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                block.style.opacity = '1';
                block.style.transform = 'translateY(0)';
            }, index * 100);
        });
    </script>
</body>
</html>